# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —ç—Ç–∏–∫–µ—Ç–æ–∫ –≤ Telegram

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—Ç–ø—Ä–∞–≤–∫—É —ç—Ç–∏–∫–µ—Ç–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –≤ Telegram –≤ –≤–∏–¥–µ —Ñ–∞–π–ª–æ–≤ (PDF –∏–ª–∏ JSON).

## –§–æ—Ä–º–∞—Ç—ã —ç—Ç–∏–∫–µ—Ç–æ–∫

API Uzum –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —ç—Ç–∏–∫–µ—Ç–∫–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö:

1. **PDF (base64)** - –≥–æ—Ç–æ–≤–∞—è –∫ –ø–µ—á–∞—Ç–∏ —ç—Ç–∏–∫–µ—Ç–∫–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ PDF
2. **URL** - —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∞–π–ª —ç—Ç–∏–∫–µ—Ç–∫–∏ (–æ–±—ã—á–Ω–æ PDF)
3. **JSON** - –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç—Ç–∏–∫–µ—Ç–∫–∏ (–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ HTML –¥–ª—è –ø–µ—á–∞—Ç–∏)

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
- **PDF** ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç
- **URL** ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å—Å—ã–ª–∫–æ–π  
- **JSON** ‚Üí –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è HTML-—ç—Ç–∏–∫–µ—Ç–∫–∞ –¥–ª—è –ø–µ—á–∞—Ç–∏ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä

## –°–ø–æ—Å–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∫–∏

### 1. –ü—Ä—è–º–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Bot API (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–≥–¥–∞ `VITE_TELEGRAM_BOT_TOKEN` –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ.

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**

1. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```env
VITE_TELEGRAM_BOT_TOKEN=your_bot_token_here
```

2. –§–∞–π–ª –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ Telegram —á–µ—Ä–µ–∑ Bot API

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ë—ã—Å—Ç—Ä–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –†–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –≤–∏–¥–µ–Ω –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π)

### 2. –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é (–±–µ–∑–æ–ø–∞—Å–Ω–æ)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–≥–¥–∞ —Ç–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Cloudflare Workers:**

1. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Cloudflare:
```bash
wrangler secret put TELEGRAM_BOT_TOKEN
```

2. –§–∞–π–ª `/functions/api/send-telegram-file.js` —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase Edge Functions:**

1. –î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç –≤ Supabase:
```bash
supabase secrets set TELEGRAM_BOT_TOKEN=your_bot_token_here
```

2. –î–µ–ø–ª–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:
```bash
supabase functions deploy send-telegram-file
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ (UzumOrders.tsx)

```typescript
async function handlePrintLabel(orderId) {
  // 1. –ü–æ–ª—É—á–∞–µ–º —ç—Ç–∏–∫–µ—Ç–∫—É –∏–∑ Uzum API
  const result = await getFbsOrderLabel(token, orderId);
  
  // 2. –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ–æ—Ä–º–∞—Ç (PDF/URL/JSON)
  if (result.labelPdf) {
    // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º base64 PDF –≤ Blob
  } else if (result.labelUrl) {
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º URL –∫–∞–∫ —Å–æ–æ–±—â–µ–Ω–∏–µ
  } else {
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º JSON –¥–∞–Ω–Ω—ã–µ
  }
  
  // 3. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram
  if (BOT_TOKEN_AVAILABLE) {
    // –ü—Ä—è–º–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Bot API
  } else {
    // –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
  }
}
```

### –°–µ—Ä–≤–µ—Ä–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è

–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç POST –∑–∞–ø—Ä–æ—Å –∫ `/api/send-telegram-file`:

```json
{
  "chatId": 123456789,
  "fileName": "uzum-label-12345.pdf",
  "fileContent": "base64_or_json_content",
  "mimeType": "application/pdf",
  "caption": "üìã –≠—Ç–∏–∫–µ—Ç–∫–∞ –¥–ª—è –∑–∞–∫–∞–∑–∞ #12345"
}
```

## Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

–ï—Å–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram –Ω–µ —É–¥–∞–ª–∞—Å—å:

1. **PDF/JSON** - —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä
2. **URL** - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —ç—Ç–∏–∫–µ—Ç–∫–∏

```bash
curl -X GET \
  "https://api-seller.uzum.uz/api/seller-openapi/v1/fbs/order/{orderId}/labels/print" \
  -H "Authorization: YOUR_TOKEN"
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram

```bash
# –ß–µ—Ä–µ–∑ Cloudflare Worker
curl -X POST https://your-domain.pages.dev/api/send-telegram-file \
  -H "Content-Type: application/json" \
  -d '{
    "chatId": 123456789,
    "fileName": "test-label.json",
    "fileContent": "{\"test\": true}",
    "mimeType": "application/json",
    "caption": "Test label"
  }'
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –≠—Ç–∏–∫–µ—Ç–∫–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `TELEGRAM_BOT_TOKEN` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –±–æ—Ç–∞ (–¥–æ–ª–∂–µ–Ω —É–º–µ—Ç—å –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ñ–∞–π–ª—ã)

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Chat ID:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
   - –î–æ–ª–∂–µ–Ω –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è `chatId` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç —ç—Ç–∏–∫–µ—Ç–∫–∏:**
   - –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏, —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç API Uzum
   - –ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

### –§–∞–π–ª –ø—Ä–∏—Ö–æ–¥–∏—Ç –∫–∞–∫ —Ç–µ–∫—Å—Ç

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `mimeType` –≤ –∑–∞–ø—Ä–æ—Å–µ
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PDF –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–µ–∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –∏–∑ base64

### CORS –æ—à–∏–±–∫–∏

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ CORS headers –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–æ–º–µ–Ω —Ä–∞–∑—Ä–µ—à–µ–Ω

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ:**

1. **–ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –≤ –ø—É–±–ª–∏—á–Ω–æ–º –∫–æ–¥–µ**
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω
3. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –ø—Ä–∞–≤–∞ –±–æ—Ç–∞ (—Ç–æ–ª—å–∫–æ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤)
4. –í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ Chat ID –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
5. –õ–æ–≥–∏—Ä—É–π—Ç–µ –≤—Å–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–ª—è –∞—É–¥–∏—Ç–∞

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤

```typescript
// –í uzum-api.ts
if (data.format === 'png') {
  return { success: true, labelImage: data.image, label: data };
}
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –≤ —Å–æ–æ–±—â–µ–Ω–∏–µ

```typescript
formData.append('reply_markup', JSON.stringify({
  inline_keyboard: [[
    { text: 'üñ®Ô∏è –ü–µ—á–∞—Ç—å', callback_data: `print_${orderId}` },
    { text: 'üìã –î–µ—Ç–∞–ª–∏', callback_data: `details_${orderId}` }
  ]]
}));
```

## –°–º. —Ç–∞–∫–∂–µ

- [Telegram Bot API - sendDocument](https://core.telegram.org/bots/api#senddocument)
- [Uzum API Documentation](https://api-seller.uzum.uz/docs)
- [Cloudflare Workers Docs](https://developers.cloudflare.com/workers/)
- [Supabase Edge Functions](https://supabase.com/docs/guides/functions)
