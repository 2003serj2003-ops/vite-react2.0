# üéØ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏

## ‚ö° –≠–∫—Å–ø—Ä–µ—Å—Å-–ø—Ä–æ–≤–µ—Ä–∫–∞ (2 –º–∏–Ω—É—Ç—ã)

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ dev-—Å–µ—Ä–≤–µ—Ä
```bash
npm run dev
```

### 2. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```
http://localhost:5173
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Uzum –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **Uzum** (–≤ –º–µ–Ω—é —Å–ª–µ–≤–∞)
2. –í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à —Ç–æ–∫–µ–Ω –≤ –ø–æ–ª–µ "API Token"
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"Test token"** –∏–ª–∏ **"Connect"**

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
**–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:**
```
‚úÖ üè™ Raw shops API response: [...]
‚úÖ üìã Raw orders count API response: 42
```

**–ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
‚ùå CORS error
‚ùå Failed to fetch
‚ùå 404 Not Found
```

---

## üîç –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞
- curl/Swagger —Ä–∞–±–æ—Ç–∞–ª–∏ ‚úÖ
- –ò–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ ‚ùå
- –ü—Ä–∏—á–∏–Ω–∞: –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É Vite proxy –∏ Cloudflare Functions

### –†–µ—à–µ–Ω–∏–µ
**–ï–¥–∏–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è DEV –∏ PROD:**
```javascript
// –¢–µ–ø–µ—Ä—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ:
fetch('/api/uzum-proxy', {
  method: 'GET',  // –∏–ª–∏ POST/PUT/DELETE
  headers: {
    'X-Uzum-Path': '/v1/shops',  // —Ü–µ–ª–µ–≤–æ–π –ø—É—Ç—å –≤ Uzum API
    'Authorization': token         // —Ç–æ–∫–µ–Ω –ë–ï–ó "Bearer"
  }
})
```

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
1. ‚úÖ `src/lib/uzum-api.ts` - –ø–µ—Ä–µ–¥–∞—á–∞ –ø—É—Ç–∏ —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫
2. ‚úÖ `vite.config.ts` - —á—Ç–µ–Ω–∏–µ X-Uzum-Path –≤ –ø—Ä–æ–∫—Å–∏
3. ‚úÖ `functions/api/uzum-proxy.js` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π handler

---

## üì¶ –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### –°–±–æ—Ä–∫–∞ –∏ –¥–µ–ø–ª–æ–π
```bash
# –°–±–æ—Ä–∫–∞
npm run build

# –î–µ–ø–ª–æ–π –Ω–∞ Cloudflare Pages
npx wrangler pages deploy dist
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ PROD
–û—Ç–∫—Ä–æ–π—Ç–µ production URL –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ —à–∞–≥–∏ 3-4 –≤—ã—à–µ.

---

## üß™ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –¢–µ—Å—Ç —á–µ—Ä–µ–∑ Node.js —Å–∫—Ä–∏–ø—Ç
```bash
node test_proxy_fix.mjs <–≤–∞—à_—Ç–æ–∫–µ–Ω> <shop_id>
```

**–ü—Ä–∏–º–µ—Ä:**
```bash
node test_proxy_fix.mjs "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." 96273
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∫—Å–∏ Uzum API...

1Ô∏è‚É£ –ü—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ Uzum API (–±–µ–∑ –ø—Ä–æ–∫—Å–∏):
   ‚úÖ getShops(): OK, –º–∞–≥–∞–∑–∏–Ω–æ–≤: 1
   ‚úÖ getFbsOrdersCount(COMPLETED): OK, –∑–∞–∫–∞–∑–æ–≤: 42

2Ô∏è‚É£ –ó–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–∫—Å–∏:
   ‚úÖ getShops(): OK, –º–∞–≥–∞–∑–∏–Ω–æ–≤: 1
   ‚úÖ getFbsOrdersCount(COMPLETED): OK, –∑–∞–∫–∞–∑–æ–≤: 42

‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!
```

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "X-Uzum-Path header is required"
**–†–µ—à–µ–Ω–∏–µ:** –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞ (Ctrl+Shift+R) –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev-—Å–µ—Ä–≤–µ—Ä

### –ü—Ä–æ–±–ª–µ–º–∞: CORS error –≤ DEV
**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ vite.config.ts —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```bash
grep -A 15 "'/api/uzum-proxy'" vite.config.ts
```

### –ü—Ä–æ–±–ª–µ–º–∞: 404 –≤ PROD
**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ functions/api/uzum-proxy.js –∑–∞–¥–µ–ø–ª–æ–µ–Ω:
```bash
ls -la functions/api/uzum-proxy.js
npm run build
npx wrangler pages deploy dist
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- `PROXY_FIX_CHECKLIST.md` - –ø–æ–ª–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
- `PROXY_FIX_DIFF.md` - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ç—á–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `test_proxy_fix.mjs` - —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —á–µ–∫–ª–∏—Å—Ç

- [ ] Dev-—Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω (`npm run dev`)
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ (http://localhost:5173)
- [ ] Uzum —Ä–∞–∑–¥–µ–ª –æ—Ç–∫—Ä—ã—Ç
- [ ] –¢–æ–∫–µ–Ω –≤—Å—Ç–∞–≤–ª–µ–Ω
- [ ] "Test token" –Ω–∞–∂–∞—Ç
- [ ] –ö–æ–Ω—Å–æ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ø–µ—à–Ω—ã–µ –ª–æ–≥–∏
- [ ] –ù–µ—Ç CORS –æ—à–∏–±–æ–∫
- [ ] –°–±–æ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ (`npm run build`)

**–ï—Å–ª–∏ –≤—Å–µ –ø—É–Ω–∫—Ç—ã ‚úÖ ‚Äî –ø—Ä–æ–∫—Å–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ! üéâ**
